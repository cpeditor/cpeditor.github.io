{{ $fragment := (urls.Parse .Destination).Fragment }}
<a href="{{ with .Page.GetPage (strings.TrimSuffix (print "#" $fragment) .Destination) }}{{ .RelPermalink }}{{ if ne $fragment "" }}#{{ $fragment }}{{ end }}{{ else }}{{ .Destination | safeURL }}{{ end }}"{{ with .Title}} title="{{ . }}"{{ end }}{{ if strings.HasPrefix .Destination "http" }} target="_blank"{{ end }}>{{ safeHTML .Text }}</a>
